---
title: "Longitudinal Assortative Mating EDA: Transition to Parenthood"
author: "Linh Nguyen"
date: "`r Sys.Date()`"
output: 
  html_document:
    toc: true
    toc_depth: 4
    toc_float: true
    code_folding: 'hide'
---
# I. Meta-data

In order to replicate this code file, two files are needed in the directory `data/ttp/` found within the project directory: `TTP Data Request.xlsx`, `TTP_Measure Summary.xlsx`, and `Phase 1 All Items.sav`. R code associated with each code chunk can be viewed and hidden by toggling on `Code` on the top right of each output.

```{r setup, results = 'hide', message = FALSE, warning = FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
options(digits = 3)

libraries <- c("apaTables",    # for cor table
               "here",         # directory access
               "psych",        # for scale alphas
               "tidyr",        # pivot_wider
               "rio",          # import export
               "summarytools", # descriptives
               "ggtext",       # for custom css title
               "ggplot2",      # plots
               "kableExtra",   # scroll box
               "forcats",      # fct_reorder for barplot
               "sjPlot",       # plot_grid
               "dplyr",        # general wrangling
               "lmerTest")     # linear mixed models

lapply(libraries, require, character.only = TRUE)

source("00_helpers.R")
```

```{r session-info, message = FALSE, warning = FALSE, results = "hold"}
# list of loaded packages and versions
si <- devtools::session_info()[[2]]
rownames(si) <- NULL
si %>% 
  select(package, loadedversion, date, source) %>% 
  
  #red bold the called packages
  mutate(package = 
           cell_spec(package, 
                     color = ifelse(package %in% libraries, "red", "black"),
                     bold = ifelse(package %in% libraries, TRUE, FALSE))) %>% 
  knitr::kable(escape = F, caption = "All loaded packages. 
               Bolded in red are those loaded explicitly 
               with <code>library()</code>") %>% 
  kable_styling() %>% 
  scroll_box(height = "300px")
```

# II. Basic Descriptives

```{r cleaning, results = 'hide'}
# data and dictionary
data <- rio::import(file = paste0(here(), "/data/ttp/TTP Data Request.xlsx"))
wave_1 <- rio::import(file = paste0(here(), "/data/ttp/Phase 1 All Items.sav")) %>%
  filter(ID %in% data$ID) %>%
  mutate(ID = as.character(ID))
dict <- rio::import(file = paste0(here(), "/data/ttp/TTP_Measure Summary.xlsx"), 
                    sheet = "Scale Specfications") %>% 
  select(c("Measure", "Variable Name", "Scaling")) %>% 
  filter(!is.na(Measure))
codebook <- rio::import(file = paste0(here(), "/data/ttp/Dictionary.xlsx"))

# variable type
data <- data %>%
  # each ID refers to a dyad. 5 first rows are P1 then P2
  mutate(ID = as.character(ID),
         Asex = as.factor(Asex),
         Ababysex = as.factor(Ababysex),
         P1Arace = as.factor(P1Arace),
         P1Aeducate = as.factor(P1Aeducate),
         P1Aincome = as.factor(P1Aincome))

# add time variable
data <- data %>%
  # time in months from first assessment
  # pre-natal is roughly 6 weeks prior
  # add 1 month to each subsequent time
  mutate(time = rep(c(0,7,13,19,25),
                    times = 168*2)) %>%
  relocate(time, .after = ID)

# check var names in dictionary
var_name <- names(data)[-c(1,2)]
var_missing <- c()
for (var in var_name){
  if(!var %in% dict$`Variable Name`){
    var_missing <- append(x = var_missing, var)
  }
}

# save only variables of interest in dict
dict <- dict %>%
  filter(`Variable Name` %in% var_name)

# difference between P1Ammonths and P1Amtotalmo
# P1Ammonths includes additional months beyond P1Amyears
# same for P1Altmon1 and P1Altotalmo
# for relationship length: only use P1Amtotalmo and P1Altotalmo
data %>%
  filter(time == 0) %>%
  select(P1Ammonths, P1Amtotalmo) %>%
  summary()

# add a unique variable per participant = ID + Sex (0)
data <- data %>% 
  mutate(IDg = paste0(ID, "_", as.numeric(Asex == 1)))

# wide-ish data with 1 row representing 1 couple at 1 timepoint
#   needed for analyses
data_wide <- data %>%
  # remove unnecessary variables
  select(-c("IDg", "Ababysex", matches("LA"))) %>%
  # rename variables for more readability
  rename(couple = ID,
         ecr_avoid = ABAvoid,
         ecr_anx   = ABAnx,
         ss_partner = Assp,
         ss_self    = Assind,
         sp_partner = Aspsp,
         sp_self    = Aisps,
         ks_prox_partner = ApProx,
         ks_sens_partner = Appsens,
         ks_coop_partner = ApCoop,
         ks_comp_partner = ApComp,
         ks_prox_self    = AiProx,
         ks_sens_self    = AiSens,
         ks_coop_self    = AiCoop,
         ks_comp_self    = AiComp,
         con_collab_partner = Apkrcll,
         con_capit_partner  = Apkrac,
         con_stale_partner  = Apkrs,
         con_verba_partner  = Apkrva,
         con_collab_self    = Aikrcll,
         con_capit_self     = Aikrac,
         con_stale_self     = Aikrs,
         con_verba_self     = Aikrva,
         das_satis = Asatis,
         das_coh   = Acohes,
         bfi_e = P1AbfiE,
         bfi_a = P1AbfiA,
         bfi_c = P1AbfiC,
         bfi_n = P1AbfiN,
         bfi_o = P1AbfiO) %>%
  # old code: male = 1, female = -1
  # new code: male = 0, female = 1
  mutate(Asex = ifelse(Asex == 1, 2, 1))
data_wide <- data_wide %>%
  pivot_wider(id_cols = c("couple", "time"),
              names_from = "Asex",
              values_from = names(data_wide)[!names(data_wide)%in%
                                          c("couple", "Asex", "time")])

# check that all IDs appear exactly 5 times
#sum(table(data$couple)!=5)

# impute ss variables for female at wave 1 from raw data
#   sort wave_1 ID using data_wide$couple to cbind easily
order_ID <- match(data_wide[data_wide$time==0,]$couple, wave_1$ID)
wave_1 <- wave_1[order_ID, ]
#   grab items specific to ss_self_1
ss_self_1_items <- wave_1 %>%
  select(names(wave_1)[grepl("^P1Fssind[0-9]+$", names(wave_1))])
#   grab items specific to ss_partner_2
ss_partner_1_items <- wave_1 %>%
  select(names(wave_1)[grepl("^P1Fssp[0-9]+$", names(wave_1))])
#   store scale scores in data_wide for time 1
data_wide[data_wide$time == 0,]$ss_self_1 <- rowMeans(ss_self_1_items, na.rm = T)
data_wide[data_wide$time == 0,]$ss_partner_1 <- rowMeans(ss_partner_1_items, na.rm = T)
#   store scale scores in data for time 1
data[data$time == 0 & data$Asex == -1,]$Assind <- rowMeans(ss_self_1_items, na.rm = T)
data[data$time == 0 & data$Asex == -1,]$Assp <- rowMeans(ss_partner_1_items, na.rm = T)

# fix character ID and standardize 1 -> length
data_wide <- data_wide %>%
  mutate(couple = as.numeric(couple)) %>%
  arrange(couple)
data_wide$couple <- rep(1:length(unique(data_wide$couple)), each = 5)

# save data files
# to be used in the analyses
#rio::export(data_wide, 
#            paste0(here(), "/data/cleaned_data_ttp.RDS"))
```

```{r dict}
# print dictionary for easy viewing
dict %>%
  knitr::kable(escape = F, caption = "All variables in analytic dataset") %>% 
  kable_styling() %>% 
  scroll_box(height = "300px")
```

```{r cormat, eval = F, include = F}
apa.cor.table(data_wide %>% 
                filter(time == 0) %>%
                select(
                  "bfi_a_1", "bfi_c_1", "bfi_e_1", "bfi_n_1", "bfi_o_1",
                  "ecr_avoid_1", "ecr_anx_1",
                  "ss_self_1", "ss_partner_1",
                  "sp_self_1", "sp_partner_1",
                  "ks_prox_self_1", "ks_prox_partner_1",
                  "ks_sens_self_1", "ks_sens_partner_1",
                  "ks_coop_self_1", "ks_coop_partner_1",
                  "ks_comp_self_1", "ks_comp_partner_1",
                  "con_collab_self_1", "con_collab_partner_1",
                  "con_capit_self_1", "con_capit_partner_1",
                  "con_stale_self_1", "con_stale_partner_1",
                  "con_verba_self_1", "con_verba_partner_1",
                  "das_satis_1", "das_coh_1"),
              filename = paste0(here(), "/results/cormat_female_ttp.doc"))
apa.cor.table(data_wide %>% 
                filter(time == 0) %>%
                select(
                  "bfi_a_2", "bfi_c_2", "bfi_e_2", "bfi_n_2", "bfi_o_2",
                  "ecr_avoid_2", "ecr_anx_2",
                  "ss_self_2", "ss_partner_2",
                  "sp_self_2", "sp_partner_2",
                  "ks_prox_self_2", "ks_prox_partner_2",
                  "ks_sens_self_2", "ks_sens_partner_2",
                  "ks_coop_self_2", "ks_coop_partner_2",
                  "ks_comp_self_2", "ks_comp_partner_2",
                  "con_collab_self_2", "con_collab_partner_2",
                  "con_capit_self_2", "con_capit_partner_2",
                  "con_stale_self_2", "con_stale_partner_2",
                  "con_verba_self_2", "con_verba_partner_2",
                  "das_satis_2", "das_coh_2"),
              filename = paste0(here(), "/results/cormat_male_ttp.doc"))
```

There are a total of `r nrow(unique(data_wide[!is.na(data_wide$ecr_avoid_1) & !is.na(data_wide$ecr_avoid_2) & data_wide$time==0, "couple"]))` couples at time 1, `r nrow(unique(data_wide[!is.na(data_wide$ecr_avoid_1) & !is.na(data_wide$ecr_avoid_2) &  data_wide$time==7, "couple"]))` couples at time 2, `r nrow(unique(data_wide[!is.na(data_wide$ecr_avoid_1) & !is.na(data_wide$ecr_avoid_2) & data_wide$time==13, "couple"]))` couples at time 3, `r nrow(unique(data_wide[!is.na(data_wide$ecr_avoid_1) & !is.na(data_wide$ecr_avoid_2) & data_wide$time==19, "couple"]))` couples at time 4, and `r nrow(unique(data_wide[!is.na(data_wide$ecr_avoid_1) & !is.na(data_wide$ecr_avoid_2) & data_wide$time==25, "couple"]))` couples at time 5, using the ECR Avoidance variable to assess missingness.


## Baseline demographics

```{r alphas}
for(trait in c("Agreeableness", "Conscientiousness", "Extraversion",
               "Neuroticism", "Openness",
               "Attachment Anxiety", "Attachment Avoidance",
               "Social Support - Self", "Social Support - Partner",
               "Social Provision - Self", "Social Provision - Partner",
               "Sensitivity Caregiving - Self", "Sensitivity Caregiving - Partner",
               "Proximity Caregiving - Self", "Proximity Caregiving - Partner",
               "Cooperation Caregiving - Self", "Cooperation Caregiving - Partner",
               "Compulsive Caregiving - Self", "Compulsive Caregiving - Partner",
               "Collaboration - Self", "Collaboration - Partner", 
               "Stalemate - Self", "Stalemate - Partner",
               "Avoidance-Capitulation - Self", "Avoidance-Capitulation - Partner",
               "Verbal Aggression - Self", "Verbal Aggression - Partner",
               "Dyadic Satisfaction", "Dyadic Cohesion")) {
  # extract male and female items in codebook
  items_male <- codebook %>% 
    filter(scale == trait & partner == "male") %>%
    pull(variable)
  items_female <- codebook %>% 
    filter(scale == trait & partner == "female") %>%
    pull(variable)
  
  # extract dataframes and combine
  df_male <- wave_1 %>%
    select(all_of(items_male))
  names(df_male) <- paste0("item_", 1:ncol(df_male))
  df_female <- wave_1 %>%
    select(all_of(items_female))
  names(df_female) <- paste0("item_", 1:ncol(df_female))
  df_trait <- rbind(df_male, df_female)
  
  # reverse items
  reverse_items <- codebook %>% 
    filter(scale == trait & partner == "male")
  reverse_items <- which(reverse_items$key == -1)
  df_trait[, reverse_items] <- codebook[codebook$scale == trait, "max"][1] + 1 - 
                               df_trait[, reverse_items]

  # output alphas
  cat(paste(trait, "Cronbach's alpha =", 
            round(psych::alpha(df_trait)$total["raw_alpha"], 2), "\n"))
}
```


```{r demo descr, results = 'asis'}
data %>% 
  filter(time == 0) %>%
  select("P1Aage", "P1Amtotalmo", "P1Altotalmo") %>%
  descr(stats = "common", order = "p")
```

```{r demo-plots-cont}
# age
p <- plot_hist(var = "P1Aage", var_name = "age in years", data = data, bin_width = 1, 
          var_sex = "Asex", female_male = c("-1", "1"))


if(signif(var = "P1Aage",
          var_sex = "Asex",
          data = data,
          female_male = c("-1", "1"))) {
  p <- p + labs(subtitle = "Significant sex difference (p < 0.05)")
}
p


# relationship length 
plot_hist(var = "P1Amtotalmo", var_name = "marriage length in months", data = data,
          bin_width = 1, 
          var_sex = "Asex", female_male = c("-1", "1"))
```

```{r demo-plots-cat}
# sex
ggplot(data[which(data$time == 0),], 
       aes(factor(Asex,
                  levels = c(-1, 1),
                  labels = c("-1", "1")))) + 
  geom_bar(fill = c("#f1c232", "#710c0c")) + 
  geom_text(stat='count', aes(label=..count..), vjust = -1) + 
  labs(
    title = "Count of Sex of the Partners",
    subtitle = "All couples are heterosexual",
    x = NULL
  ) +
  ylim(0, 200) +
  theme_classic()

# baby sex
ggplot(data[which(data$time == 0),], 
       aes(factor(Ababysex,
                  levels = c(-1, 1),
                  labels = c("-1", "1")))) + 
  geom_bar(fill = c("#f1c232", "#710c0c")) + 
  geom_text(stat='count', aes(label=..count..), vjust = -1) + 
  labs(
    title = "Count of Sex of the Baby",
    x = NULL
  ) +
  ylim(0, 200) +
  theme_classic()

# count of race
ggplot(data[which(data$time == 0 & !is.na(data$P1Arace)),], 
       aes(factor(P1Arace,
                  levels = 1:4,
                  labels = c("white", "2","3","4")))) + 
  geom_bar(fill = c("#710c0c")) + 
  geom_text(stat='count', aes(label=..count..), vjust = -1) + 
  labs(
    title = "Count of race",
    x = NULL
  ) +
  ylim(0, 300) +
  theme_classic()

# count of level of education
ggplot(data[which(data$time == 0 & !is.na(data$P1Aeducate)),], 
       aes(factor(P1Aeducate,
                  levels = c(-1, 2:7),
                  labels = as.character(c(1:7))))) + 
  geom_bar(fill = c("#710c0c")) + 
  geom_text(stat='count', aes(label=..count..), vjust = -1) + 
  labs(
    title = "Count of education levels",
    x = NULL
  ) +
  ylim(0, 175) +
  theme_classic()

# count of income
ggplot(data[which(data$time == 0 & !is.na(data$P1Aincome)),], 
       aes(factor(P1Aincome,
                  levels = 1:7,
                  labels = as.character(c(1:7))))) + 
  geom_bar(fill = c("#710c0c")) + 
  geom_text(stat='count', aes(label=..count..), vjust = -1) + 
  labs(
    title = "Count of income levels",
    x = NULL
  ) +
  ylim(0, 120) +
  theme_classic()
```

## Baseline personality

```{r bfi-descr}
data_wide %>%
  filter(time == 0) %>%
  select(bfi_e_1:bfi_o_2) %>%
  descr(stats = "common") %>%
  knitr::kable(
    caption = "Baseline Big Five descriptives for all participants"
  ) %>%
  kable_styling() %>%
  scroll_box(height = "300px")
```

```{r bfi-plots}
# agreeableness
p <- plot_hist(var = "P1AbfiA", var_name = "BFI Agreeableness", 
               data = data, bin_width = 0.2,
               var_sex = "Asex", female_male = c("-1", "1")) +
  xlim(1,5)

if(signif(var = "P1AbfiA",
          var_sex = "Asex",
          data = data,
          female_male = c("-1", "1"))) {
  p <- p + labs(subtitle = "Significant sex difference (p < 0.05)")
}
p

# conscientiousness
p <- plot_hist(var = "P1AbfiC", var_name = "BFI Conscientiousness", 
               data = data, bin_width = 0.2,
               var_sex = "Asex", female_male = c("-1", "1")) +
  xlim(1,5)

if(signif(var = "P1AbfiC",
          var_sex = "Asex",
          data = data,
          female_male = c("-1", "1"))) {
  p <- p + labs(subtitle = "Significant sex difference (p < 0.05)")
}
p


# extraversion
p <- plot_hist(var = "P1AbfiE", var_name = "BFI Extraversion", 
               data = data, bin_width = 0.2,
               var_sex = "Asex", female_male = c("-1", "1")) +
  xlim(1,5)

if(signif(var = "P1AbfiE",
          var_sex = "Asex",
          data = data,
          female_male = c("-1", "1"))) {
  p <- p + labs(subtitle = "Significant sex difference (p < 0.05)")
}
p


# neuroticism
p <- plot_hist(var = "P1AbfiN", var_name = "BFI Neuroticism", 
               data = data, bin_width = 0.2,
               var_sex = "Asex", female_male = c("-1", "1")) +
  xlim(1,5)

if(signif(var = "P1AbfiN",
          var_sex = "Asex",
          data = data,
          female_male = c("-1", "1"))) {
  p <- p + labs(subtitle = "Significant sex difference (p < 0.05)")
}
p

# openness
p <- plot_hist(var = "P1AbfiO", var_name = "BFI Openness", 
               data = data, bin_width = 0.2,
               var_sex = "Asex", female_male = c("-1", "1")) +
  xlim(1,5)

if(signif(var = "P1AbfiO",
          var_sex = "Asex",
          data = data,
          female_male = c("-1", "1"))) {
  p <- p + labs(subtitle = "Significant sex difference (p < 0.05)")
}
p
```

## Baseline relationship

```{r rela-descr}
data_wide %>%
  filter(time == 0) %>%
  select(ecr_avoid_1:con_verba_self_2, das_satis_1:das_coh_2) %>%
  descr(stats = "common") %>%
  knitr::kable(
    caption = "Baseline relationship CAs descriptives for all participants"
  ) %>%
  kable_styling() %>%
  scroll_box(height = "300px")
```


### Experiences in Close Relationships

```{r ecr-descr}
# global avoidance
p <- plot_hist(var = "ABAvoid", var_name = "ECR Global Avoidance", 
               data = data, bin_width = 0.2,
               var_sex = "Asex", female_male = c("-1", "1")) +
  xlim(1,7)

if(signif(var = "ABAvoid",
          var_sex = "Asex",
          data = data,
          female_male = c("-1", "1"))) {
  p <- p + labs(subtitle = "Significant sex difference (p < 0.05)")
}
p

# global anxiety
p <- plot_hist(var = "ABAnx", var_name = "ECR Global Anxiety", 
               data = data, bin_width = 0.2,
               var_sex = "Asex", female_male = c("-1", "1")) +
  xlim(1,7)

if(signif(var = "ABAnx",
          var_sex = "Asex",
          data = data,
          female_male = c("-1", "1"))) {
  p <- p + labs(subtitle = "Significant sex difference (p < 0.05)")
}
p
```

### Sarason's Social Support

```{r sss-descr}
# perceived from partner
p <- plot_hist(var = "Assp", var_name = "Social Support - Perceived from Partner", 
               data = data, bin_width = 0.2,
               var_sex = "Asex", female_male = c("-1", "1")) +
  xlim(1,7)

if(signif(var = "Assp",
          var_sex = "Asex",
          data = data,
          female_male = c("-1", "1"))) {
  p <- p + labs(subtitle = "Significant sex difference (p < 0.05)")
}
p

# self-reported given to partner
p <- plot_hist(var = "Assind", var_name = "Social Support - Social Support - Self to Partner", 
               data = data, bin_width = 0.2,
               var_sex = "Asex", female_male = c("-1", "1")) +
  xlim(1,7)

if(signif(var = "Assind",
          var_sex = "Asex",
          data = data,
          female_male = c("-1", "1"))) {
  p <- p + labs(subtitle = "Significant sex difference (p < 0.05)")
}
p
```

### Cutrona's Procial Provisions

```{r cpp-descr}
# perceived from partner
p <- plot_hist(var = "Aspsp", var_name = "Social Provisions - Perceived from Partner", 
               data = data, bin_width = 0.1,
               var_sex = "Asex", female_male = c("-1", "1")) +
  xlim(-1,1)

if(signif(var = "Aspsp",
          var_sex = "Asex",
          data = data,
          female_male = c("-1", "1"))) {
  p <- p + labs(subtitle = "Significant sex difference (p < 0.05)")
}
p

# self-reported given to partner
p <- plot_hist(var = "Aisps", var_name = "Social Provisions - Self to Partner", 
               data = data, bin_width = 0.1,
               var_sex = "Asex", female_male = c("-1", "1")) +
  xlim(-1,1)

if(signif(var = "Aisps",
          var_sex = "Asex",
          data = data,
          female_male = c("-1", "1"))) {
  p <- p + labs(subtitle = "Significant sex difference (p < 0.05)")
}
p
```

### Kunce and Shaver

```{r ks-descr}
# self-reported Proximity v. Distance
p <- plot_hist(var = "AiProx", var_name = "Self-Reported Proximity v. Distance", 
               data = data, bin_width = 0.2,
               var_sex = "Asex", female_male = c("-1", "1")) +
  xlim(1,7)+
  ylim(0,60)

if(signif(var = "AiProx",
          var_sex = "Asex",
          data = data,
          female_male = c("-1", "1"))) {
  p <- p + labs(subtitle = "Significant sex difference (p < 0.05)")
}
p

# perceived-partner Proximity v. Distance
p <- plot_hist(var = "ApProx", var_name = "Perceived-Partner's Proximity v. Distance", 
               data = data, bin_width = 0.2,
               var_sex = "Asex", female_male = c("-1", "1")) +
  xlim(1,7)+
  ylim(0,60)

if(signif(var = "ApProx",
          var_sex = "Asex",
          data = data,
          female_male = c("-1", "1"))) {
  p <- p + labs(subtitle = "Significant sex difference (p < 0.05)")
}
p

# self-reported Sensitivity v. Insensitivity
p <- plot_hist(var = "AiSens", var_name = "Self-Reported Sensitivity v. Insensitivity", 
               data = data, bin_width = 0.2,
               var_sex = "Asex", female_male = c("-1", "1")) +
  xlim(1,7)

if(signif(var = "AiSens",
          var_sex = "Asex",
          data = data,
          female_male = c("-1", "1"))) {
  p <- p + labs(subtitle = "Significant sex difference (p < 0.05)")
}
p

# perceived-partner Sensitivity v. Insensitivity
p <- plot_hist(var = "Appsens", var_name = "Perceived-Partner's Sensitivity v. Insensitivity", 
               data = data, bin_width = 0.2,
               var_sex = "Asex", female_male = c("-1", "1")) +
  xlim(1,7)

if(signif(var = "Appsens",
          var_sex = "Asex",
          data = data,
          female_male = c("-1", "1"))) {
  p <- p + labs(subtitle = "Significant sex difference (p < 0.05)")
}
p

# self-reported Cooperation v. Control
p <- plot_hist(var = "AiCoop", var_name = "Self-Reported Cooperation v. Control", 
               data = data, bin_width = 0.2,
               var_sex = "Asex", female_male = c("-1", "1")) +
  xlim(1,7)

if(signif(var = "AiCoop",
          var_sex = "Asex",
          data = data,
          female_male = c("-1", "1"))) {
  p <- p + labs(subtitle = "Significant sex difference (p < 0.05)")
}
p

# perceived-partner Cooperation v. Control
p <- plot_hist(var = "ApCoop", var_name = "Perceived-Partner's Cooperation v. Control", 
               data = data, bin_width = 0.2,
               var_sex = "Asex", female_male = c("-1", "1")) +
  xlim(1,7)

if(signif(var = "ApCoop",
          var_sex = "Asex",
          data = data,
          female_male = c("-1", "1"))) {
  p <- p + labs(subtitle = "Significant sex difference (p < 0.05)")
}
p

# self-reported Compulsive Caregiving
p <- plot_hist(var = "AiComp", var_name = "Self-Reported Compulsive Caregiving", 
               data = data, bin_width = 0.2,
               var_sex = "Asex", female_male = c("-1", "1")) +
  xlim(1,7)

if(signif(var = "AiComp",
          var_sex = "Asex",
          data = data,
          female_male = c("-1", "1"))) {
  p <- p + labs(subtitle = "Significant sex difference (p < 0.05)")
}
p

# perceived-partner Compulsive Caregiving
p <- plot_hist(var = "ApComp", var_name = "Perceived-Partner's Compulsive Caregiving", 
               data = data, bin_width = 0.2,
               var_sex = "Asex", female_male = c("-1", "1")) +
  xlim(1,7)

if(signif(var = "ApComp",
          var_sex = "Asex",
          data = data,
          female_male = c("-1", "1"))) {
  p <- p + labs(subtitle = "Significant sex difference (p < 0.05)")
}
p
```

### Kerig Conflict Strategies

```{r kcs-descr}
# self-reported Collaboration
p <- plot_hist(var = "Aikrcll", var_name = "Self-Reported Collaboration", 
               data = data, bin_width = 0.2,
               var_sex = "Asex", female_male = c("-1", "1")) +
  xlim(1,7)+
  ylim(0,50)

if(signif(var = "Aikrcll",
          var_sex = "Asex",
          data = data,
          female_male = c("-1", "1"))) {
  p <- p + labs(subtitle = "Significant sex difference (p < 0.05)")
}
p

# perceived-partner Collaboration
p <- plot_hist(var = "Apkrcll", var_name = "Perceived-Partner's Collaboration", 
               data = data, bin_width = 0.2,
               var_sex = "Asex", female_male = c("-1", "1")) +
  xlim(1,7)+
  ylim(0,50)

if(signif(var = "Apkrcll",
          var_sex = "Asex",
          data = data,
          female_male = c("-1", "1"))) {
  p <- p + labs(subtitle = "Significant sex difference (p < 0.05)")
}
p

# self-reported Avoidance - Capitulation
p <- plot_hist(var = "Aikrac", var_name = "Self-Reported Avoidance - Capitulation", 
               data = data, bin_width = 0.2,
               var_sex = "Asex", female_male = c("-1", "1")) +
  xlim(1,7)

if(signif(var = "Aikrac",
          var_sex = "Asex",
          data = data,
          female_male = c("-1", "1"))) {
  p <- p + labs(subtitle = "Significant sex difference (p < 0.05)")
}
p

# perceived-partner Avoidance - Capitulation
p <- plot_hist(var = "Apkrac", var_name = "Perceived-Partner's Avoidance - Capitulation", 
               data = data, bin_width = 0.2,
               var_sex = "Asex", female_male = c("-1", "1")) +
  xlim(1,7)

if(signif(var = "Apkrac",
          var_sex = "Asex",
          data = data,
          female_male = c("-1", "1"))) {
  p <- p + labs(subtitle = "Significant sex difference (p < 0.05)")
}
p

# self-reported Stalemate
p <- plot_hist(var = "Aikrs", var_name = "Self-Reported Stalemate", 
               data = data, bin_width = 0.2,
               var_sex = "Asex", female_male = c("-1", "1")) +
  xlim(1,7)+
  ylim(0,50)

if(signif(var = "Aikrs",
          var_sex = "Asex",
          data = data,
          female_male = c("-1", "1"))) {
  p <- p + labs(subtitle = "Significant sex difference (p < 0.05)")
}
p

# perceived-partner Stalemate
p <- plot_hist(var = "Apkrs", var_name = "Perceived-Partner's Stalemate", 
               data = data, bin_width = 0.2,
               var_sex = "Asex", female_male = c("-1", "1")) +
  xlim(1,7)+
  ylim(0,50)

if(signif(var = "Apkrs",
          var_sex = "Asex",
          data = data,
          female_male = c("-1", "1"))) {
  p <- p + labs(subtitle = "Significant sex difference (p < 0.05)")
}
p

# self-reported Verbal Aggression
p <- plot_hist(var = "Aikrva", var_name = "Self-Reported Verbal Aggression", 
               data = data, bin_width = 0.2,
               var_sex = "Asex", female_male = c("-1", "1")) +
  xlim(1,7)

if(signif(var = "Aikrva",
          var_sex = "Asex",
          data = data,
          female_male = c("-1", "1"))) {
  p <- p + labs(subtitle = "Significant sex difference (p < 0.05)")
}
p

# perceived-partner Verbal Aggression
p <- plot_hist(var = "Apkrva", var_name = "Perceived-Partner's Verbal Aggression", 
               data = data, bin_width = 0.2,
               var_sex = "Asex", female_male = c("-1", "1")) +
  xlim(1,7)

if(signif(var = "Apkrva",
          var_sex = "Asex",
          data = data,
          female_male = c("-1", "1"))) {
  p <- p + labs(subtitle = "Significant sex difference (p < 0.05)")
}
p
```

### Dyadic Satisfaction and Cohesion

```{r das-descr}
# dyadic satisfaction
p <- plot_hist(var = "Asatis", var_name = "Dyadic Satisfaction", 
               data = data, bin_width = 2,
               var_sex = "Asex", female_male = c("-1", "1")) +
  xlim(1,50)

if(signif(var = "Asatis",
          var_sex = "Asex",
          data = data,
          female_male = c("-1", "1"))) {
  p <- p + labs(subtitle = "Significant sex difference (p < 0.05)")
}
p

# dyadic cohesion
p <- plot_hist(var = "Acohes", var_name = "Dyadic Cohesion", 
               data = data, bin_width = 1,
               var_sex = "Asex", female_male = c("-1", "1")) +
  xlim(1,25)

if(signif(var = "Acohes",
          var_sex = "Asex",
          data = data,
          female_male = c("-1", "1"))) {
  p <- p + labs(subtitle = "Significant sex difference (p < 0.05)")
}
p
```

# III. Longitudinal Descriptives

For ease of presentation, all longitudinal plots are shown with a random sample of 100 participants.

```{r long-sample}
set.seed(202211)
sample <- sample(unique(data$IDg), size = 100)
sample <- data %>% filter(IDg %in% c(sample))
```

### Experiences in Close Relationships

```{r ecr-long}
# global avoidance
p <- ggplot(data = sample,
             aes(x = time, y = ABAvoid, group = IDg)) + 
  geom_line(linetype = "dashed") +
  stat_smooth(aes(data = sample$ABAvoid, group = 1),
              method = "lm",
              formula = y ~ poly(x, 2),
              lwd = 1.5, color = "red") +
  labs(x = "Time in months",
       y = "Global Avoidance") +
  theme_classic()

if(signifc("ABAvoid", data = data)) {
  p <- p +
    labs(subtitle = "Significant linear slope (p < .05)")
}
p

#global anxiety
p <- ggplot(data = sample,
             aes(x = time, y = ABAnx, group = IDg)) + 
  geom_line(linetype = "dashed") +
  stat_smooth(aes(data = sample$ABAnx, group = 1),
              method = "lm",
              formula = y ~ poly(x, 2),
              lwd = 1.5, color = "red") +
  labs(x = "Time in months",
       y = "Global Anxiety") +
  theme_classic()

if(signifc("ABAnx", data = data)) {
  p <- p +
    labs(subtitle = "Significant linear slope (p < .05)")
}
p
```

### Sarason's Social Support

```{r sss-long}
# perceived from partner
p <- ggplot(data = sample,
             aes(x = time, y = Assp, group = IDg)) + 
  geom_line(linetype = "dashed") +
  stat_smooth(aes(data = sample$Assp, group = 1),
              method = "lm",
              formula = y ~ poly(x, 2),
              lwd = 1.5, color = "red") +
  labs(x = "Time in months",
       y = "Perceived social support from partner") +
  theme_classic()

if(signifc("Assp", data = data)) {
  p <- p +
    labs(subtitle = "Significant linear slope (p < .05)")
}
p

# self-reported given to partner
p <- ggplot(data = sample,
             aes(x = time, y = Assind, group = IDg)) + 
  geom_line(linetype = "dashed") +
  stat_smooth(aes(data = sample$Assind, group = 1),
              method = "lm",
              formula = y ~ poly(x, 2),
              lwd = 1.5, color = "red") +
  labs(x = "Time in months",
       y = "Self-reported social support given to partner") +
  theme_classic()

if(signifc("Assind", data = data)) {
  p <- p +
    labs(subtitle = "Significant linear slope (p < .05)")
}
p
```

### Cutrona's Procial Provisions

```{r cpp-long}
# perceived from partner
p <- ggplot(data = sample,
             aes(x = time, y = Aspsp, group = IDg)) + 
  geom_line(linetype = "dashed") +
  stat_smooth(aes(data = sample$Aspsp, group = 1),
              method = "lm",
              formula = y ~ poly(x, 2),
              lwd = 1.5, color = "red") +
  labs(x = "Time in months",
       y = "Perceived social provisions from partner") +
  theme_classic()

if(signifc("Aspsp", data = data)) {
  p <- p +
    labs(subtitle = "Significant linear slope (p < .05)")
}
p

# self-reported given to partner
p <- ggplot(data = sample,
             aes(x = time, y = Aisps, group = IDg)) + 
  geom_line(linetype = "dashed") +
  stat_smooth(aes(data = sample$Aisps, group = 1),
              method = "lm",
              formula = y ~ poly(x, 2),
              lwd = 1.5, color = "red") +
  labs(x = "Time in months",
       y = "Self-reported social provisions given to partner") +
  theme_classic()

if(signifc("Aisps", data = data)) {
  p <- p +
    labs(subtitle = "Significant linear slope (p < .05)")
}
p
```

### Kunce and Shaver

```{r ks-long}
# self-reported Proximity v. Distance
p <- ggplot(data = sample,
             aes(x = time, y = AiProx, group = IDg)) + 
  geom_line(linetype = "dashed") +
  stat_smooth(aes(data = sample$AiProx, group = 1),
              method = "lm",
              formula = y ~ poly(x, 2),
              lwd = 1.5, color = "red") +
  labs(x = "Time in months",
       y = "Self-reported Proximity v. Distance") +
  theme_classic()

if(signifc("AiProx", data = data)) {
  p <- p +
    labs(subtitle = "Significant linear slope (p < .05)")
}
p

# perceived-partner Proximity v. Distance
p <- ggplot(data = sample,
             aes(x = time, y = ApProx, group = IDg)) + 
  geom_line(linetype = "dashed") +
  stat_smooth(aes(data = sample$ApProx, group = 1),
              method = "lm",
              formula = y ~ poly(x, 2),
              lwd = 1.5, color = "red") +
  labs(x = "Time in months",
       y = "Perceived-partner Proximity v. Distance") +
  theme_classic()

if(signifc("ApProx", data = data)) {
  p <- p +
    labs(subtitle = "Significant linear slope (p < .05)")
}
p

# self-reported Sensitivity v. Insensitivity
p <- ggplot(data = sample,
             aes(x = time, y = AiSens, group = IDg)) + 
  geom_line(linetype = "dashed") +
  stat_smooth(aes(data = sample$AiSens, group = 1),
              method = "lm",
              formula = y ~ poly(x, 2),
              lwd = 1.5, color = "red") +
  labs(x = "Time in months",
       y = "Self-reported Sensitivity v. Insensitivity") +
  theme_classic()

if(signifc("AiSens", data = data)) {
  p <- p +
    labs(subtitle = "Significant linear slope (p < .05)")
}
p

# perceived-partner Sensitivity v. Insensitivity
p <- ggplot(data = sample,
             aes(x = time, y = Appsens, group = IDg)) + 
  geom_line(linetype = "dashed") +
  stat_smooth(aes(data = sample$Appsens, group = 1),
              method = "lm",
              formula = y ~ poly(x, 2),
              lwd = 1.5, color = "red") +
  labs(x = "Time in months",
       y = "Perceived-partner Sensitivity v. Insensitivity") +
  theme_classic()

if(signifc("Appsens", data = data)) {
  p <- p +
    labs(subtitle = "Significant linear slope (p < .05)")
}
p

# self-reported Cooperation v. Control
p <- ggplot(data = sample,
             aes(x = time, y = AiCoop, group = IDg)) + 
  geom_line(linetype = "dashed") +
  stat_smooth(aes(data = sample$AiCoop, group = 1),
              method = "lm",
              formula = y ~ poly(x, 2),
              lwd = 1.5, color = "red") +
  labs(x = "Time in months",
       y = "Self-reported Cooperation v. Control") +
  theme_classic()

if(signifc("AiCoop", data = data)) {
  p <- p +
    labs(subtitle = "Significant linear slope (p < .05)")
}
p

# perceived-partner Cooperation v. Control
p <- ggplot(data = sample,
             aes(x = time, y = ApCoop, group = IDg)) + 
  geom_line(linetype = "dashed") +
  stat_smooth(aes(data = sample$ApCoop, group = 1),
              method = "lm",
              formula = y ~ poly(x, 2),
              lwd = 1.5, color = "red") +
  labs(x = "Time in months",
       y = "Perceived-partner Cooperation v. Control") +
  theme_classic()

if(signifc("ApCoop", data = data)) {
  p <- p +
    labs(subtitle = "Significant linear slope (p < .05)")
}
p

# self-reported Compulsive Caregiving
p <- ggplot(data = sample,
             aes(x = time, y = AiComp, group = IDg)) + 
  geom_line(linetype = "dashed") +
  stat_smooth(aes(data = sample$AiComp, group = 1),
              method = "lm",
              formula = y ~ poly(x, 2),
              lwd = 1.5, color = "red") +
  labs(x = "Time in months",
       y = "Self-reported Compulsive Caregiving") +
  theme_classic()

if(signifc("AiComp", data = data)) {
  p <- p +
    labs(subtitle = "Significant linear slope (p < .05)")
}
p

# perceived-partner Compulsive Caregiving
p <- ggplot(data = sample,
             aes(x = time, y = ApComp, group = IDg)) + 
  geom_line(linetype = "dashed") +
  stat_smooth(aes(data = sample$ApComp, group = 1),
              method = "lm",
              formula = y ~ poly(x, 2),
              lwd = 1.5, color = "red") +
  labs(x = "Time in months",
       y = "Perceived-partner Compulsive Caregiving") +
  theme_classic()

if(signifc("ApComp", data = data)) {
  p <- p +
    labs(subtitle = "Significant linear slope (p < .05)")
}
p
```

### Kerig Conflict Strategies

```{r kcs-long}
# self-reported Collaboration
p <- ggplot(data = sample,
             aes(x = time, y = Aikrcll, group = IDg)) + 
  geom_line(linetype = "dashed") +
  stat_smooth(aes(data = sample$Aikrcll, group = 1),
              method = "lm",
              formula = y ~ poly(x, 2),
              lwd = 1.5, color = "red") +
  labs(x = "Time in months",
       y = "Self-reported Collaboration") +
  theme_classic()

if(signifc("Aikrcll", data = data)) {
  p <- p +
    labs(subtitle = "Significant linear slope (p < .05)")
}
p

# perceived-partner Collaboration
p <- ggplot(data = sample,
             aes(x = time, y = Apkrcll, group = IDg)) + 
  geom_line(linetype = "dashed") +
  stat_smooth(aes(data = sample$Apkrcll, group = 1),
              method = "lm",
              formula = y ~ poly(x, 2),
              lwd = 1.5, color = "red") +
  labs(x = "Time in months",
       y = "Perceived-partner Collaboration") +
  theme_classic()

if(signifc("Apkrcll", data = data)) {
  p <- p +
    labs(subtitle = "Significant linear slope (p < .05)")
}
p

# self-reported Avoidance - Capitulation
p <- ggplot(data = sample,
             aes(x = time, y = Aikrac, group = IDg)) + 
  geom_line(linetype = "dashed") +
  stat_smooth(aes(data = sample$Aikrac, group = 1),
              method = "lm",
              formula = y ~ poly(x, 2),
              lwd = 1.5, color = "red") +
  labs(x = "Time in months",
       y = "Self-reported Avoidance - Capitulation") +
  theme_classic()

if(signifc("Aikrac", data = data)) {
  p <- p +
    labs(subtitle = "Significant linear slope (p < .05)")
}
p

# perceived-partner Avoidance - Capitulation
p <- ggplot(data = sample,
             aes(x = time, y = Apkrac, group = IDg)) + 
  geom_line(linetype = "dashed") +
  stat_smooth(aes(data = sample$Apkrac, group = 1),
              method = "lm",
              formula = y ~ poly(x, 2),
              lwd = 1.5, color = "red") +
  labs(x = "Time in months",
       y = "Perceived-partner Avoidance - Capitulation") +
  theme_classic()

if(signifc("Apkrac", data = data)) {
  p <- p +
    labs(subtitle = "Significant linear slope (p < .05)")
}
p

# self-reported Stalemate
p <- ggplot(data = sample,
             aes(x = time, y = Aikrs, group = IDg)) + 
  geom_line(linetype = "dashed") +
  stat_smooth(aes(data = sample$Aikrs, group = 1),
              method = "lm",
              formula = y ~ poly(x, 2),
              lwd = 1.5, color = "red") +
  labs(x = "Time in months",
       y = "Self-reported Stalemate") +
  theme_classic()

if(signifc("Aikrs", data = data)) {
  p <- p +
    labs(subtitle = "Significant linear slope (p < .05)")
}
p

# perceived-partner Stalemate
p <- ggplot(data = sample,
             aes(x = time, y = Apkrs, group = IDg)) + 
  geom_line(linetype = "dashed") +
  stat_smooth(aes(data = sample$Apkrs, group = 1),
              method = "lm",
              formula = y ~ poly(x, 2),
              lwd = 1.5, color = "red") +
  labs(x = "Time in months",
       y = "Self-reported Stalemate") +
  theme_classic()

if(signifc("Apkrs", data = data)) {
  p <- p +
    labs(subtitle = "Significant linear slope (p < .05)")
}
p

# self-reported Verbal Aggression
p <- ggplot(data = sample,
             aes(x = time, y = Aikrva, group = IDg)) + 
  geom_line(linetype = "dashed") +
  stat_smooth(aes(data = sample$Aikrva, group = 1),
              method = "lm",
              formula = y ~ poly(x, 2),
              lwd = 1.5, color = "red") +
  labs(x = "Time in months",
       y = "Self-reported Verbal Aggression") +
  theme_classic()

if(signifc("Aikrva", data = data)) {
  p <- p +
    labs(subtitle = "Significant linear slope (p < .05)")
}
p

# perceived-partner Verbal Aggression
p <- ggplot(data = sample,
             aes(x = time, y = Apkrva, group = IDg)) + 
  geom_line(linetype = "dashed") +
  stat_smooth(aes(data = sample$Apkrva, group = 1),
              method = "lm",
              formula = y ~ poly(x, 2),
              lwd = 1.5, color = "red") +
  labs(x = "Time in months",
       y = "Self-reported Verbal Aggression") +
  theme_classic()

if(signifc("Apkrva", data = data)) {
  p <- p +
    labs(subtitle = "Significant linear slope (p < .05)")
}
p
```

### Dyadic Satisfaction and Cohesion

```{r das-long}
# dyadic satisfaction
p <- ggplot(data = sample,
             aes(x = time, y = Asatis, group = IDg)) + 
  geom_line(linetype = "dashed") +
  stat_smooth(aes(data = sample$Asatis, group = 1),
              method = "lm",
              formula = y ~ poly(x, 2),
              lwd = 1.5, color = "red") +
  labs(x = "Time in months",
       y = "Dyadic Satisfaction") +
  theme_classic()

if(signifc("Asatis", data = data)) {
  p <- p +
    labs(subtitle = "Significant linear slope (p < .05)")
}
p

# dyadic cohesion
p <- ggplot(data = sample,
             aes(x = time, y = Acohes, group = IDg)) + 
  geom_line(linetype = "dashed") +
  stat_smooth(aes(data = sample$Acohes, group = 1),
              method = "lm",
              formula = y ~ poly(x, 2),
              lwd = 1.5, color = "red") +
  labs(x = "Time in months",
       y = "Dyadic Cohesion") +
  theme_classic()

if(signifc("Acohes", data = data)) {
  p <- p +
    labs(subtitle = "Significant linear slope (p < .05)")
}
p
```
